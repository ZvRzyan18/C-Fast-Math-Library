#include "cfm/math.h"
#include <stdint.h>

/*
 error function
*/
double cfm_erf(double x) {
	if(*(uint64_t*)&x & 0x8000000000000000) {
	 *(uint64_t*)&x &= 0x7FFFFFFFFFFFFFFF;
	 if(x > 6.0) {
	 	return -1.0;
	 } else if(x > 3.0) {
	 	//4 degree polynomial
		 return -((((-5.6661240466817337e-06 * x + 0.00010612495308988421) * x + -0.00073559717715316513) * x + 0.002235217400497739) * x + 0.99748835754092657);
	 } else {
	  //8 degree polynomial
	  return -((((((((-0.0018826328802207409 * x + 0.022942863637175744) * x + -0.1044889321532258) * x + 0.19053301792340754) * x + 0.011428811873537377) * x + -0.42475749819282593) * x + 0.0241542422137178) * x + 1.1246493414066161) * x + 9.0065873982291729e-05);
 	}
	}
	if(x > 6.0) {
		return 1.0;
	} else if(x > 3.0) {
		//4 degree polynomial
		 return ((((-5.6661240466817337e-06 * x + 0.00010612495308988421) * x + -0.00073559717715316513) * x + 0.002235217400497739) * x + 0.99748835754092657);
	} else {
	 //8 degree polynomial
	 return ((((((((-0.0018826328802207409 * x + 0.022942863637175744) * x + -0.1044889321532258) * x + 0.19053301792340754) * x + 0.011428811873537377) * x + -0.42475749819282593) * x + 0.0241542422137178) * x + 1.1246493414066161) * x + 9.0065873982291729e-05);
	}
	return 0.0;
}


float cfm_erff(float x) {
	if(*(uint32_t*)&x & 0x80000000) {
	 *(uint32_t*)&x &= 0x7FFFFFFF;
	 if(x > 6.0f) {
	 	return -1.0f;
	 } else if(x > 3.0f) {
	 	//4 degree polynomial
		 return -((((-5.666124e-06f * x + 0.000106f) * x + -0.000735f) * x + 0.002235f) * x + 0.997488f);
	 } else {
	  //8 degree polynomial
	  return -((((((((-0.001882f * x + 0.022942f) * x + -0.104488f) * x + 0.190533f) * x + 0.011428f) * x + -0.424757f) * x + 0.024154f) * x + 1.124649f) * x + 9.006587e-05f);
 	}
	}
	if(x > 6.0f) {
		return 1.0f;
	} else if(x > 3.0f) {
		//4 degree polynomial
		return ((((-5.666124e-06f * x + 0.000106f) * x + -0.000735f) * x + 0.002235f) * x + 0.997488f);
	} else {
	 //8 degree polynomial
	 return ((((((((-0.001882f * x + 0.022942f) * x + -0.104488f) * x + 0.190533f) * x + 0.011428f) * x + -0.424757f) * x + 0.024154f) * x + 1.124649f) * x + 9.006587e-05f);
 }
	return 0.0f;
}

